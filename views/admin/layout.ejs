<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,viewport-fit=cover"
    />
    <title><%= typeof title !== 'undefined' ? title : 'Admin Panel' %></title>

    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

      
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/cdn.min.js"></script>

    <style>
      :root {
        /* Color system: 1 primary + 3 neutrals + 1 border = 5 colors total */
        --brand: rgb(160, 216, 216);   /* primary */
        --bg: #F8FAFC;                 /* neutral background */
        --surface: #FFFFFF;            /* neutral surface */
        --text: #0F172A;               /* neutral text */
        --border: #E5E7EB;             /* neutral border */
        /* Derived brand tone for hover states (no new color family) */
        --brand-600: rgb(136, 193, 193);
      }
      .brand-bg { background-color: var(--brand); }
      .brand-bg-600 { background-color: var(--brand-600); }
      .brand-text { color: var(--text); }
      .border-brand { border-color: var(--brand); }
      .ring-brand:focus { box-shadow: 0 0 0 3px rgba(160,216,216,0.5); outline: none; }
      .scroll-smooth { scroll-behavior: smooth; }
    </style>
  </head>

  <body class="scroll-smooth bg-gray-50" x-data="{ sidebarOpen: false }">

    <div
      class="fixed inset-0 bg-black bg-opacity-40 z-30 md:hidden"
      x-show="sidebarOpen"
      x-transition.opacity
      @click="sidebarOpen = false"
      aria-hidden="true"
    ></div>

    <div class="min-h-screen flex">
      
      <aside
        class="fixed z-40 inset-y-0 left-0 w-72 transform transition-transform duration-200 md:static md:translate-x-0 md:w-64 bg-white border-r border-gray-200"
        :class="{'-translate-x-full md:translate-x-0': !sidebarOpen}"
        aria-label="Sidebar Navigation"
      >
        <%- include('../partials/sidebar') %>
      </aside>

       
      <div class="flex-1 flex flex-col min-w-0 md:ml-0 md:pl-0">
         
        <header class="sticky top-0 z-20">
          <%- include('../partials/header') %>
        </header>


        <main id="main-content" class="flex-1 min-w-0 p-4 sm:p-6 md:p-8">
          <div class="mx-auto max-w-7xl">
            <%- include(body) %>
          </div>
        </main>
      </div>
    </div>

 
    <div
      id="confirmationModal"
      class="fixed inset-0 z-50"
      x-cloak
      x-show="$store.confirm.open"
      aria-labelledby="modal-title"
      role="dialog"
      aria-modal="true"
    >
      <div
        class="flex items-center justify-center min-h-screen px-4 text-center"
      >
        <div
          class="fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity"
          x-show="$store.confirm.open"
          x-transition.opacity
          aria-hidden="true"
        ></div>

        <div
          class="relative inline-block w-full max-w-lg text-left align-middle transition-all transform bg-white shadow-xl rounded-lg"
          x-show="$store.confirm.open"
          x-transition
        >
          <div class="px-6 pt-6 pb-4">
            <div class="flex items-start">
              <div class="flex-shrink-0">
                <div class="h-12 w-12 rounded-full brand-bg flex items-center justify-center">
                  <svg class="h-6 w-6 text-gray-900" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z"/>
                  </svg>
                </div>
              </div>
              <div class="ml-4">
                <h3 id="modal-title" class="text-lg font-semibold text-gray-900">
                  <span x-text="$store.confirm.action === 'block' ? 'Block User' : 'Unblock User'"></span>
                </h3>
                <p class="mt-2 text-sm text-gray-600">
                  Are you sure you want to
                  <span class="font-medium" x-text="$store.confirm.action"></span>
                  <span class="font-medium" x-text="$store.confirm.userName"></span>?
                  <span x-text="$store.confirm.action === 'block' ? 'This will prevent access to the system.' : 'This will restore access to the system.'"></span>
                </p>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 px-6 py-4 flex justify-end gap-3">
            <button
              type="button"
              class="inline-flex items-center px-4 py-2 rounded-md border border-gray-300 bg-white text-gray-800 text-sm font-medium hover:bg-gray-100 focus:ring-2 ring-brand"
              @click="$store.confirm.open = false"
            >
              Cancel
            </button>
            <button
              type="button"
              class="inline-flex items-center px-4 py-2 rounded-md brand-bg text-gray-900 text-sm font-semibold hover:brand-bg-600 focus:ring-2 ring-brand"
              @click="
                fetch(`/api/users/${$store.confirm.userId}/${$store.confirm.action}`, { method: 'POST' })
                  .then(r => r.json())
                  .then(data => { if (data && data.success) { window.location.reload(); } });
                $store.confirm.open = false;
              "
            >
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener('alpine:init', () => {
        Alpine.store('confirm', {
          open: false,
          action: '',
          userId: '',
          userName: ''
        });
      });

      window.openConfirm = function(action, userId, userName) {
        const s = Alpine.store('confirm');
        s.action = action;
        s.userId = userId;
        s.userName = userName;
        s.open = true;
      }
    </script>
  </body>
</html>